<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ガントチャート (Google Sheets連携版)</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/script.js" defer></script>
</head>
<body>
    <!-- ローディング表示 -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <div class="gantt-container">
        <!-- ... (ヘッダーやメイン部分は変更なし) ... -->
        <header class="gantt-header">
            <h1>プロジェクト・ガントチャート</h1>
            <div class="timeline-controls">
                <label for="start-year">開始年:</label>
                <input type="number" id="start-year" value="2025">
                <label for="start-month">開始月:</label>
                <input type="number" id="start-month" value="1" min="1" max="12">
                <label for="duration">期間(月):</label>
                <input type="number" id="duration-months" value="12" min="1" max="48">
                <button id="update-timeline-btn">タイムライン更新</button>
            </div>
            <div class="header-buttons">
                <button id="settings-btn" class="settings-btn">設定</button>
                <button id="addTaskBtn" class="add-task-btn">+ タスクを追加</button>
            </div>
        </header>

        <main class="gantt-main">
            <aside class="gantt-tasks">
                <div class="task-header">タスク名</div>
                <div id="task-list"></div> 
            </aside>
            <section class="gantt-chart">
                <div id="chart-header-container" class="chart-header"></div>
                <div id="chart-grid" class="chart-grid"></div>
            </section>
        </main>
    </div>

    <!-- ... (各種モーダルウィンドウは変更なし) ... -->
    <div id="add-task-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2>新しいタスクを追加</h2>
            <form id="add-task-form">
                <div class="form-group">
                    <label for="task-name">タスク名:</label>
                    <input type="text" id="task-name" required>
                </div>
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="task-start-year">開始年:</label>
                        <input type="number" id="task-start-year" required>
                    </div>
                    <div class="form-group">
                        <label for="task-start-month">開始月:</label>
                        <input type="number" id="task-start-month" min="1" max="12" required>
                    </div>
                </div>
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="task-end-year">終了年:</label>
                        <input type="number" id="task-end-year" required>
                    </div>
                     <div class="form-group">
                        <label for="task-end-month">終了月:</label>
                        <input type="number" id="task-end-month" min="1" max="12" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="task-progress">進捗率 (%):</label>
                    <input type="number" id="task-progress" min="0" max="100" value="0">
                </div>
                <div class="form-actions">
                    <button type="button" id="add-cancel-btn" class="btn-cancel">キャンセル</button>
                    <button type="submit" class="btn-save">保存</button>
                </div>
            </form>
        </div>
    </div>
    <div id="edit-task-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2>タスクを編集</h2>
            <form id="edit-task-form">
                <input type="hidden" id="edit-task-id">
                <div class="form-group">
                    <label for="edit-task-name">タスク名:</label>
                    <input type="text" id="edit-task-name" required>
                </div>
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="edit-task-start-year">開始年:</label>
                        <input type="number" id="edit-task-start-year" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-task-start-month">開始月:</label>
                        <input type="number" id="edit-task-start-month" min="1" max="12" required>
                    </div>
                </div>
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="edit-task-end-year">終了年:</label>
                        <input type="number" id="edit-task-end-year" required>
                    </div>
                     <div class="form-group">
                        <label for="edit-task-end-month">終了月:</label>
                        <input type="number" id="edit-task-end-month" min="1" max="12" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-task-progress">進捗率 (%):</label>
                    <input type="number" id="edit-task-progress" min="0" max="100" value="0">
                </div>
                <div class="form-actions-edit">
                    <button type="button" id="delete-task-btn" class="btn-delete">削除</button>
                    <div class="form-actions-right">
                        <button type="button" id="edit-cancel-btn" class="btn-cancel">キャンセル</button>
                        <button type="submit" class="btn-save">更新</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2>設定</h2>
            <form id="settings-form">
                <div class="form-group">
                    <label for="teams-webhook-url">Microsoft Teams Webhook URL:</label>
                    <input type="url" id="teams-webhook-url" placeholder="https://outlook.office.com/webhook/...">
                    <p class="form-help">タスク追加時に通知を送るTeamsチャネルのIncoming Webhook URLを入力してください。</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="settings-cancel-btn" class="btn-cancel">キャンセル</button>
                    <button type="submit" class="btn-save">保存</button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>
